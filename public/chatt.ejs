<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  




</head>
<body style="background-color: rgba(25, 216, 228, 0.2);">

  
    
<div style="background-color:  rgba(100, 164, 133, 1);;box-shadow: 1px 10px 5px 0px rgba(0, 0, 0, 0.25); " class="fixed-top"   >
    <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="http://localhost:3000/chat">home</a></li>
    <li class="breadcrumb-item active" aria-current="page">chat</li>
  </ol>
  
  <a href="http://localhost:3000/sendconversa/<%= pessoaID %>/<%= userID %>/jjj" class="text-decoration-none "> 
    Enviarddddo
              
  </a>
</nav>
   
    <div class="w-75 text-center d-flex mb-3">
        <div  style="width: 50px; height: 50px; border-radius: 50%;" class="bg-danger"></div>
      
        </div>
        </div>
      
    
   
   
   </div>

    <style>
        .conversa1{
         float: left;
        background-color: rgba(240, 255, 207, 1);
        clear: both;
        width: 40vw;
        border: 1px solid;
        display: block;
        margin: 3px;
        margin-left: 15vw;

        border-bottom-left-radius: 12px;
        border-bottom-right-radius: 12px;
        border-top-left-radius: 12px;
        padding: 12px;
        } 
        


        .conversa2{
         float: right;
        background-color: rgba(248, 251, 241, 1);
        clear: both;
        display: block;
        width: 40vw;
        margin: 3px;
        border-radius: 1px;
        border-bottom-left-radius: 12px;
        border-bottom-right-radius: 12px;
        border-top-left-radius: 12px;

        margin-right: 15vw;
        border: 1px solid;
        padding: 12px;
        
        } 



        li{
        display: block;
        }
        
ol{
  list-style-type: none;
}
</style>
         







 






    <ol id="dataList"></ol>

    <script src="https://cdn.socket.io/4.0.1/socket.io.min.js"></script>
    <script>
        const socket = io();

     
const pessoaID = "<%= pessoaID %>";
const userID  = "<%= userID %>";




socket.on('updateData', (data) => {

    console.log(data)
    const dataList = document.getElementById('dataList');
    
    // Limpe o conteúdo existente da lista antes de adicionar novos itens
    dataList.innerHTML = '';

    for (let n = 0; n < data.length; n++) {
     

  const listItem =document.createElement("li")

if(data[n].userID == userID){


    listItem.textContent = data[n].conversa;
//listItem.style.background = "red";
listItem.classList.add("conversa1");
 








}else{

    listItem.textContent = data[n].conversa;
//listItem.style.background = "green"
listItem.classList.add("conversa2");


}
 

dataList.appendChild(listItem);


    }
});

 
        socket.emit('getData');
    </script>


 

<script>
  
    function conversa(botao){
    const conversa = document.getElementById("digiteconversar")
     
    fetch('http://localhost:3000/sendconversa/' + '<%= pessoaID %>/<%= userID %>/' + conversa.value, {
        method: 'GET'
    })
    .then(response => {
        // Verifica se a resposta está OK (status 2xx)
        if (response.ok) {
            // Converte a resposta para JSON, se aplicável
            console.log("deu certo")
            window.location.reload(true)
          //  return response.json();
        } else {
            // Se a resposta não estiver OK, lança um erro
            throw new Error('Erro na solicitação GET');
        }
    })
    .then(data => {
        // Manipula os dados da resposta bem-sucedida
        console.log('Resposta bem-sucedida:', data);
    })
    .catch(error => {
        // Captura e trata qualquer erro durante a solicitação
        console.error('Erro:', error);
    });
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
     
             
         }
    
    
    
    
    
    
    
    
    
    
    </script>
    

<a href=""></a>










    

<div class="fixed-bottom d-flex container-fluid p-2  w-100  ">
<div class="mx-auto w-75">



    <input  placeholder="digite..." class="w-75 rounded-5 p-2"  id="digiteconversar"> 


    <button class="h-25 bg-transparent border-0"  id="nextPage" onclick="conversa(this)">
      <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" fill="currentColor" class="bi bi-arrow-right-circle-fill" viewBox="0 0 16 16">
        <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/>
      </svg>

    </button>





</div>
    
  </div>
  

</body>
</html>


























</body>
</html>
